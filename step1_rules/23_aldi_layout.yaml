# Aldi layout rules
# Multiple layouts that apply based on file extension, header text, or content
aldi_layouts:
  # Variant A: With QTY
  - name: "Aldi Excel v_qty_total"
    parsed_by: "aldi_excel_v1"
    applies_to:
      vendor_code: ["ALDI"]
      file_ext: [".xlsx", ".xls"]
      header_contains:
        - "Item Description"
        - "Extended Amount"
    required_columns:
      - "Item Description"
      - "Extended Amount (USD)"
    optional_columns:
      - "QTY"
      - "Item Number"
      - "UPC"
      - "Transaction Date"
    column_mappings:
      product_name: "Item Description"
      quantity: "QTY"
      total_price: '(Extended\s+Amount(\s*\(USD\))?|Total\s+Price)'
      item_number: "Item Number"
      upc: "UPC"
      transaction_date: "Transaction Date"
    normalization:
      trim_whitespace: true
    skip_patterns:
      # Note: Do NOT add control keywords like "TOTAL", "TAX", "Total Items" here
      # They are handled by CONTROL_PATTERNS in layout_applier.py
      - "B:Taxable"

  # Variant B: No QTY column
  - name: "Aldi Excel v_total_only"
    parsed_by: "aldi_excel_v2"
    applies_to:
      vendor_code: ["ALDI"]
      file_ext: [".xlsx", ".xls"]
      header_contains:
        - "Item Description"
        - "Extended Amount"
    required_columns:
      - "Item Description"
      - "Extended Amount (USD)"
    column_mappings:
      product_name: "Item Description"
      total_price: '(Extended\s+Amount(\s*\(USD\))?|Total\s+Price)'
    normalization:
      trim_whitespace: true
    skip_patterns:
      # Note: Do NOT add control keywords like "TOTAL", "TAX", "Total Items" here
      # They are handled by CONTROL_PATTERNS in layout_applier.py
      - "B:Taxable"
