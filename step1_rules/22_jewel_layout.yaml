# Jewel/Mariano's layout rules
# Multiple layouts that apply based on file extension, header text, or content
jewel_layouts:
  # Variant A: With QTY and Extended Amount present
  - name: "Jewel Excel v_qty_total"
    parsed_by: "jewel_excel_v1"
    applies_to:
      vendor_code: ["JEWEL", "JEWELOSCO", "MARIANOS"]
      file_ext: [".xlsx", ".xls"]
      header_contains:
        - "Item Description"
        - "Extended Amount"
    required_columns:
      - "Item Description"
      - "Extended Amount (USD)"
    optional_columns:
      - "Transaction Date"
      - "QTY"
    column_mappings:
      product_name: "Item Description"
      quantity: "QTY"
      total_price: '(Extended\s+Amount(\s*\(USD\))?|Total\s+Price)'
    normalization:
      trim_whitespace: true
      preserve_case: true
    skip_patterns:
      # Note: Do NOT add control keywords like "TOTAL", "TAX", "Total Items Sold" here
      # They are handled by CONTROL_PATTERNS in layout_applier.py
      - "BALANCE"

  # Variant B: No QTY; default quantity to 1
  - name: "Jewel Excel v_total_only"
    parsed_by: "jewel_excel_v2"
    applies_to:
      vendor_code: ["JEWEL", "JEWELOSCO", "MARIANOS"]
      file_ext: [".xlsx", ".xls"]
      header_contains:
        - "Item Description"
        - "Extended Amount"
    required_columns:
      - "Item Description"
      - "Extended Amount (USD)"
    column_mappings:
      product_name: "Item Description"
      total_price: '(Extended\s+Amount(\s*\(USD\))?|Total\s+Price)'
    normalization:
      trim_whitespace: true
    skip_patterns:
      # Note: Do NOT add control keywords like "TOTAL", "TAX", "Total Items Sold" here
      # They are handled by CONTROL_PATTERNS in layout_applier.py
      - "BALANCE"
